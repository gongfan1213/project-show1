<img width="538" alt="image" src="https://github.com/user-attachments/assets/06c9593d-c58a-45c1-af4c-1a7cf30c5dc7" />
### **RightclickMenu 组件详解**

`RightclickMenu` 是一个 React 组件，用于实现右键菜单功能，主要用于 2D 编辑器的上下文菜单操作。以下是对代码的详细讲解，包括功能、实现细节和关键逻辑。

---

## **1. 功能概述**

### **1.1 功能**
1. **右键菜单显示与隐藏**：
   - 根据鼠标右键点击的位置显示菜单。
   - 支持菜单的动态位置调整，避免超出屏幕范围。

2. **菜单选项动态生成**：
   - 根据当前选中的对象（`activeObject`）动态生成菜单选项。
   - 支持菜单选项的启用/禁用、显示/隐藏。

3. **子菜单支持**：
   - 支持多级菜单（如“图层操作”和“对齐操作”）。
   - 子菜单的显示位置根据屏幕大小动态调整。

4. **菜单操作**：
   - 提供多种操作，如复制、粘贴、删除、翻转、对齐、分组、解组、锁定、解锁等。

5. **事件处理**：
   - 通过事件系统（`useEvent`）监听和触发菜单相关的操作。

---

## **2. 代码结构分析**

### **2.1 核心逻辑**
1. **菜单选项生成**：
   - 使用 `generateMenuOptions` 函数动态生成菜单选项。
   - 每个选项包含 `id`、`label`、`图标`、`快捷键提示`、`启用状态` 等属性。

2. **菜单显示与隐藏**：
   - 使用 `showMenu` 和 `hideMenu` 函数控制菜单的显示和隐藏。
   - 菜单位置根据鼠标点击位置动态调整，避免超出屏幕范围。

3. **菜单选项的动态更新**：
   - 根据当前选中的对象（`activeObject`）动态更新菜单选项的启用/禁用状态。

4. **菜单操作处理**：
   - 使用 `handleMenuClick` 函数处理菜单选项的点击事件。
   - 根据选项的 `id` 执行对应的操作。

---

### **2.2 关键状态和变量**
1. **`menuOptions`**：
   - 存储所有菜单选项的配置。
   - 每个选项包含 `id`、`label`、`图标`、`快捷键提示`、`启用状态`、`子菜单` 等信息。

2. **`menuStyle`**：
   - 控制菜单的样式（如位置、可见性）。

3. **`menuShowPosition`**：
   - 存储菜单的显示位置（`x` 和 `y` 坐标）。

4. **`menuRef`**：
   - 菜单的 DOM 引用，用于获取菜单的宽高和绑定事件。

---

## **3. 代码详解**

### **3.1 菜单选项生成**


#### **功能**
- 动态生成菜单选项。
- 每个选项包含以下属性：
  - **`id`**：选项的唯一标识。
  - **`label`**：选项的文本。
  - **`headIcon`**：选项的图标。
  - **`labelTips`**：快捷键提示。
  - **`disabled`**：是否禁用。

#### **实现细节**
- 使用 `MenuOptionId` 枚举定义选项的 `id`。
- 使用 `getTranslation` 函数获取多语言文本。
- 根据操作系统（Windows 或 Mac）动态生成快捷键提示。

---

### **3.2 菜单显示与隐藏**

#### **显示菜单**


#### **隐藏菜单**


#### **功能**
- 根据鼠标点击位置显示菜单。
- 动态调整菜单位置，避免超出屏幕范围。
- 隐藏菜单时，将菜单位置设置为不可见区域。

#### **实现细节**
1. **动态调整位置**：
   - 如果菜单高度超出屏幕高度，向上调整位置。
   - 如果菜单宽度超出屏幕宽度，向左调整位置。
2. **设置样式**：
   - 使用 `setMenuStyle` 更新菜单的样式。

---

### **3.3 菜单选项的动态更新**

#### **功能**
- 根据当前选中的对象（`activeObject`）动态更新菜单选项的状态。

#### **实现细节**
1. **启用/禁用选项**：
   - 如果没有选中对象，禁用相关选项（如复制、删除等）。
2. **显示/隐藏选项**：
   - 如果选中的是分组对象，显示“解组”选项，隐藏“分组”选项。

---

### **3.4 菜单操作处理**


#### **功能**
- 根据选项的 `id` 执行对应的操作。

#### **实现细节**
1. **调用编辑器方法**：
   - 使用 `canvasEditor` 提供的方法执行操作（如复制、粘贴、删除等）。
2. **事件触发**：
   - 通过 `event.emit` 触发相关事件（如锁定、解锁等）。

---

## **4. 总结**

### **4.1 功能总结**
- **右键菜单显示与隐藏**：根据鼠标位置动态显示菜单，支持多级菜单。
- **菜单选项动态生成**：根据当前选中的对象动态更新菜单选项的状态。
- **菜单操作处理**：支持多种操作，如复制、粘贴、删除、翻转、对齐、分组等。

### **4.2 技术亮点**
1. **动态菜单生成**：
   - 使用函数动态生成菜单选项，支持多语言和图标配置。
2. **位置调整**：
   - 根据屏幕大小动态调整菜单位置，避免超出屏幕范围。
3. **事件驱动**：
   - 使用事件系统（`useEvent`）实现菜单的显示、隐藏和操作。

如果你对某些具体的实现细节有疑问，可以进一步提问，我会详细解答！
