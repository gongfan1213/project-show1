

---

## **第一部分：文字变形功能（Transform）**

### **功能描述**
该部分代码实现了对文字对象的变形操作，允许用户将文字变形为不同的形状（如圆形、角度、贝塞尔曲线等）。

### **主要功能**
1. **变形类型选择**
   - 提供多种变形类型（如自定义、圆形、角度、贝塞尔曲线等）。
   - 用户可以点击不同的变形类型按钮，应用对应的变形效果。

2. **变形状态管理**
   - 使用`eventBus`监听和触发变形状态的事件。
   - 当文字处于变形状态时，触发`TextStatus.UnderTransform`事件。
   - 当变形结束时，触发`EventNameCons.ChangeEditorSaveState`事件，保存编辑状态。

3. **实时渲染**
   - 通过`setRenderFlag`强制组件重新渲染，以更新UI状态。
   - 调用`canvasEditor.canvas.requestRenderAll()`实时更新画布中的文字对象。

4. **变形逻辑**
   - 根据用户选择的变形类型，设置文字对象的`_transformType`属性。
   - 如果用户再次点击相同的变形类型，则取消变形。

5. **关闭左侧工具栏**
   - 提供关闭按钮，允许用户关闭左侧的变形工具栏。

---

### **用户交互流程**
1. 用户打开左侧的变形工具栏。
2. 用户点击某种变形类型（如圆形、角度等）。
3. 文字对象应用对应的变形效果。
4. 用户可以再次点击取消变形，或选择其他变形类型。
5. 用户完成操作后，可以关闭工具栏。

---

## **第二部分：字体选择功能（Typeface）**

### **功能描述**
该部分代码实现了字体选择和管理功能，允许用户从字体库中选择字体并应用到文字对象。

### **主要功能**
1. **字体库加载**
   - 从CMS接口动态加载字体库数据，包括字体名称、类型、URL等。
   - 支持分页加载，每次加载20个字体。

2. **字体分类**
   - 提供多种字体分类（如Serif、Sans Serif、Script等）。
   - 用户可以点击分类标签，筛选对应类型的字体。

3. **字体搜索**
   - 提供搜索框，用户可以输入字体名称进行搜索。
   - 使用`debounce`优化搜索请求，减少频繁的接口调用。

4. **字体筛选**
   - 提供筛选功能，用户可以根据语言等条件筛选字体。
   - 支持多选筛选条件，并动态更新字体列表。

5. **字体应用**
   - 用户点击某个字体后，将该字体应用到选中的文字对象。
   - 支持多选文字对象，批量应用字体。
   - 如果字体是默认字体（如`Times New Roman`），直接应用。
   - 如果字体是自定义字体，先加载字体文件，再应用到文字对象。

6. **字体缓存**
   - 使用`fontFamiliesCache`缓存字体数据，减少重复请求。
   - 缓存按分类存储，支持快速切换分类。

7. **最近使用**
   - 显示最近使用的字体，方便用户快速选择。

8. **动态样式**
   - 动态设置字体的`@font-face`样式，确保字体在画布中正确渲染。

9. **加载状态**
   - 使用`Loading`组件显示字体加载状态，提升用户体验。

---

### **用户交互流程**
1. 用户打开左侧的字体工具栏。
2. 用户可以：
   - 点击分类标签，切换字体分类。
   - 在搜索框中输入字体名称，搜索字体。
   - 点击筛选按钮，选择语言等筛选条件。
3. 用户点击某个字体，将其应用到选中的文字对象。
4. 用户可以滚动加载更多字体，或查看最近使用的字体。

---

## **总结**

### **第一部分：文字变形功能（Transform）**
- **核心功能**：提供多种文字变形效果（如圆形、角度、贝塞尔曲线等）。
- **用户体验**：通过简单的点击操作，快速应用或取消文字变形。
- **技术实现**：
  - 使用`eventBus`管理变形状态。
  - 动态更新文字对象的`_transformType`属性。
  - 实时渲染画布，更新变形效果。

---

### **第二部分：字体选择功能（Typeface）**
- **核心功能**：从字体库中选择字体并应用到文字对象。
- **用户体验**：支持分类、搜索、筛选、最近使用等功能，方便用户快速找到所需字体。
- **技术实现**：
  - 动态加载字体库数据，支持分页加载。
  - 使用`@font-face`动态设置字体样式。
  - 支持多选文字对象，批量应用字体。
  - 使用缓存优化字体加载性能。

---
