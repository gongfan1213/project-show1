<img width="1093" alt="image" src="https://github.com/user-attachments/assets/c76be0e7-ff4d-4033-b9d8-de77507aaa47" />


## **功能模块分析**

### **1. 对话框的基本功能**
- **打开与关闭**：
  - `open` 属性控制对话框的显示与隐藏。
  - `onClose` 方法用于关闭对话框，并重置相关状态。
- **关闭按钮**：
  - 提供关闭按钮，点击后会触发 `handleClose` 方法，重置选项并关闭对话框。

---

### **2. 画布类型选择**
- **画布类型选项**：
  - 提供两种画布类型供用户选择：
    1. **平面画布（Flat Canvas）**：适用于普通的平面设计。
    2. **圆柱画布（Cylindrical Canvas）**：适用于圆柱形物体（如杯子）的设计。
  - 画布类型通过 `selectedCanvasType` 状态管理，用户点击后会触发 `handleCanvasTypeChange` 方法切换画布类型。
  - 使用 `eventBus` 触发 `EventCanvasTypeChange` 事件，通知其他组件画布类型的变化。

- **画布类型的动态加载**：
  - 根据画布类型加载对应的选项数据：
    - 平面画布选项存储在 `mockMaterialData` 中。
    - 圆柱画布选项存储在 `mockCylindricalData` 中。
  - 数据通过 `fetchSonClass` 方法从 `ProjectManager` 中获取。

---

### **3. 画布选项选择**
- **一级分类选择**：
  - 用户可以选择一级分类（如不同的画布类型）。
  - 选中后，会更新 `selectedOption` 状态，并加载对应的二级选项（`optionList`）。

- **二级选项选择**：
  - 用户可以选择具体的画布模板（如 A4、A3 或特定的圆柱形杯子）。
  - 选中后，会更新 `selectedCreate` 状态，并设置默认的画布尺寸、方向等参数。

---

### **4. 画布参数设置**
- **尺寸设置**：
  - 用户可以手动输入画布的宽度、高度等参数。
  - 对于圆柱画布，还可以设置顶部直径、底部直径和高度。
  - 输入框会根据画布类型动态显示不同的参数（如平面画布只显示宽高，圆柱画布显示顶部直径、底部直径和高度）。

- **单位切换**：
  - 支持切换画布尺寸的单位（如毫米 `mm`、英寸 `in`）。
  - 单位切换通过 `setUnit` 方法实现。

- **方向设置**：
  - 用户可以选择画布的方向（水平或垂直）。
  - 对于圆柱画布，还可以选择是否带有手柄。
  - 方向切换通过 `handleOrientationChange` 方法实现。

---

### **5. 项目创建与替换**
- **创建新项目**：
  - 用户点击“创建”按钮后，会触发 `handleSubmit` 方法。
  - 根据用户输入的参数，生成一个新的项目请求（`createProjectRequest`）。
  - 如果项目创建成功，会调用 `onCreate` 回调，将新项目数据传递给父组件。

- **替换现有项目**：
  - 如果对话框是从编辑器中打开的（`editPath` 为 `true`），用户可以选择替换当前项目。
  - 替换逻辑通过 `replaceProject` 方法实现，会更新现有项目的画布类型和参数。

---

### **6. 数据加载与状态管理**
- **数据加载**：
  - 通过 `fetchSonClass` 方法加载画布选项数据。
  - 数据分为两类：平面画布数据（`mockMaterialData`）和圆柱画布数据（`mockCylindricalData`）。

- **状态管理**：
  - 使用 `useState` 管理组件的状态，包括：
    - 当前选中的画布类型（`selectedCanvasType`）。
    - 当前选中的一级分类（`selectedOption`）。
    - 当前选中的二级选项（`selectedCreate`）。
    - 用户输入的画布参数（`width`、`height` 等）。
    - 是否禁用提交按钮（`submitDisabled`）。
  - 使用 `useEffect` 动态更新状态，如根据画布类型加载数据、根据 URL 参数设置初始状态等。

---

### **7. 用户交互与验证**
- **表单验证**：
  - 使用 `Form` 组件对用户输入的参数进行验证。
  - 如果用户输入的参数不合法（如宽度或高度小于 1），会自动修正为最小值。

- **按钮交互**：
  - “创建”按钮会根据用户的输入状态动态启用或禁用。
  - 鼠标悬停时，会显示不同的样式。

- **关闭对话框**：
  - 用户可以通过点击关闭按钮或调用 `onClose` 方法关闭对话框。

---

### **8. 动画与加载状态**
- **加载动画**：
  - 在数据加载过程中，会显示加载动画（`LoadingAnimation`）。
  - 加载状态通过 `loading` 和 `createloading` 状态管理。

- **动态效果**：
  - 使用 `clsx` 动态切换样式，如选中状态、悬停状态等。

---

### **9. 国际化支持**
- 使用 `useTranslation` 和 `useCustomTranslation` 提供多语言支持。
- 所有文本内容（如按钮名称、提示信息等）都通过翻译键（如 `TranslationsKeys`）进行管理。

---

## **总结**
这段代码实现了一个功能丰富的画布选择与创建对话框，主要功能包括：

1. **画布类型选择**：支持平面画布和圆柱画布的切换。
2. **画布选项选择**：支持选择具体的画布模板（如 A4、A3 或特定的圆柱形杯子）。
3. **画布参数设置**：支持手动输入画布尺寸、切换单位、设置方向等。
4. **项目创建与替换**：支持创建新项目或替换现有项目。
5. **数据加载与状态管理**：动态加载画布选项数据，并根据用户选择更新状态。
6. **用户交互与验证**：提供表单验证、按钮交互、关闭对话框等功能。
7. **动画与加载状态**：在数据加载过程中显示加载动画。
8. **国际化支持**：支持多语言翻译。

通过这些功能，用户可以方便地选择和创建适合自己需求的画布，并快速开始设计工作。
